# Ember

2018年KDD上提取使用lightgbm进行恶意软件检测的模型，除公开数据与模型外同时公开特征提取代码。

论文：《Ember: an open dataset for training static pe malware machine learning models》

数据集地址：[https://github.com/endgameinc/ember](https://github.com/endgameinc/ember)

特征提取代码：[https://github.com/elastic/ember/blob/master/ember/features.py](https://github.com/elastic/ember/blob/master/ember/features.py)

### 模型

由ember特征提取程序提取到的特征，共2351维特征包括：

* **ImpertsInfo** ：提取从IAT中提取导入库和导入表信息，将导入库与导入库+导入函数的组合分别制作feature hash，然后最终形成导入表特征向量。
* **ExportsInfo** ：提取导出函数信息，计算导出向量。
* **SectionInfo** ：PE文件中各个节的名字、大小、交叉熵、虚拟大小、属性，使用哈希技巧将节信息形成一个特征向量
* **HeaderInfo** ：提取PE头部信息，包括时间戳、机器类型、PE文件类型、系统、链接器等
* **GeneralInfo** ：PE文件整体情况，包括文件大小，虚拟大小、是否有debug对象、导入导出函数数量、是否具有重定位、是否有resource、对象、签名、tls等
* **StringInfo** ：在原始比特流中提取字符串特征，包括系统路径出现次数、URL出现次数、注册表跟键、可执行DOS标记等特征
* **ByteEntropyHistogram** ：2维字节熵直方图
* **ByteHistogram** ：字节分布直方图统计

**模型：Lightgbm**

**训练时间：23h（特征提取20+模型训练3h）**

### 效果

* 0.1误报率的条件下检出率可达92.99%
* 1%误报率的条件下检出率可达98.2%
